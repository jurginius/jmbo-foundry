{% load pagination_tags foundry_inclusion_tags %}

<script type="text/javascript">
$(document).ready(function(){
    $('a.comment-reply').live('click', function(event){
        event.preventDefault();
        // Update hidden input, focus comment form
        var form = $(this).parents('div.object-comments:first form');
        $('input[name="in_reply_to"]', form).val($(this).attr('comment_id'));
        var area = $('textarea', form);        
        //area.val('@:');
        area.focus();
    });
});
</script>

Auto Update: {% if request.GET.comment_auto_update %}On{% else %}Turn Off{% endif %}

<div class="foundry-navbar foundry-comments-messages-navbar">
    <div class="items">
        <div class="item first {% if not request.GET.my_messages %}active{% endif %}">
            <a href=".">All Messages</a>
        </div>
        <div class="item last {% if request.GET.my_messages %}active{% endif %}">
            <a href="?my_messages=1">My Messages</a>
        </div>
    </div>
</div>

{% with request.GET.paginate_by|default:2|add:0 as paginate_by %}

    <div class="foundry-navbar foundry-comments-pages-navbar">
        <div class="items">
            <div class="item first">Show</div>
            {% with '2 3 4'|as_list:'int' as li %}
                {% for n in li %}
                    <div class="item {% if paginate_by == n %}active{% endif %} {% if forloop.last %}last{% endif %}">
                        <a href="?paginate_by={{ n }}{% if request.GET.my_messages %}&my_messages=1{% endif %}">{{ n }}</a>
                    </div>
                {% endfor %}
            {% endwith %}
        </div>
    </div>

    <div class="foundry-container foundry-comments-list">
    
        {% autopaginate comment_list paginate_by %}
        {% for comment in comment_list %}
            <div id="c{{ comment.id }}" class="title">
                {{ comment.submit_date }} - {{ comment.name }}
            </div>
            <div class="items">
                <div class="item">
                    {{ comment.comment }}
                    <br />
                    <!-- todo: Need can comment test -->
                    <a href="#" class="comment-reply" comment_id="{{ comment.id }}">Reply</a>
                </div>
            </div>
        {% endfor %}
        {% paginate %}

    </div>

{% endwith %}
